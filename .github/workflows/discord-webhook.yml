name: GitHub All Events to Discord

on:
  # ëª¨ë“  ì´ë²¤íŠ¸ ê°ì§€
  push:
  pull_request:
  issues:
  issue_comment:
  delete:
  release:
  workflow_run:
    workflows: ["*"]
    types:
      - completed

jobs:
  discordNotification:
    runs-on: ubuntu-latest
    steps:
      - name: Send message to Discord
        env:
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        run: |
          EVENT_TYPE="${{ github.event_name }}"
          REPO_NAME="${{ github.repository }}"
          ACTOR="${{ github.actor }}"
          EVENT_URL="https://github.com/${{ github.repository }}/actions"

          # JSON ë°ì´í„° ìƒì„±
          PAYLOAD=$(jq -n \
            --arg username "GitHub Webhook" \
            --arg content "ğŸ“¢ **GitHub ì´ë²¤íŠ¸ ë°œìƒ!**\nğŸ”” ì´ë²¤íŠ¸ íƒ€ì…: ${EVENT_TYPE}\nğŸ“Œ ë ˆí¬ì§€í† ë¦¬: ${REPO_NAME}\nğŸ‘¤ ì‹¤í–‰ì: ${ACTOR}\nğŸ”— [ì´ë²¤íŠ¸ ë³´ê¸°](${EVENT_URL})" \
            '{username: $username, content: $content}')

          # Discord ì›¹í›… ìš”ì²­ ë³´ë‚´ê¸°
          curl -H "Content-Type: application/json" \
               -X POST \
               -d "$PAYLOAD" \
               "$DISCORD_WEBHOOK_URL"
